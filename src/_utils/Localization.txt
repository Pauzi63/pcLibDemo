import { useState } from 'react';
import LocalizedStrings from 'react-localization';

import globals from './Globals';

import DE_AT from "./languages/DE-AT"
import EN_UK from "./languages/EN-UK"

export const useLanguage = () => {
  const [, setSate] = useState<string>();
  const language = window.localStorage.getItem(globals.languageKey);
  const setLanguage = (language: string) => {
    window.localStorage.setItem(globals.languageKey, language);
    strings.setLanguage(language);
    setSate(language);
  }
  return { language, setLanguage };
}

export class Localization {
  static initialize = () => {
    const { language, setLanguage } = useLanguage();
    if (language === null) {
      setLanguage(strings.getAvailableLanguages().includes(navigator.language) ? navigator.language : globals.languageDefault)
    } else {
      strings.setLanguage(language);
    }

  }
}
 
const strings = new LocalizedStrings({
  de: DE_AT,
  en: EN_UK
});

export default strings;